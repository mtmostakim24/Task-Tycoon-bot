<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Task Tycoon Bot</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
    body { background: #f2f2f2; padding-bottom: 80px; }
    header {
      background: white; padding: 15px 10px;
      display: flex; justify-content: space-between;
      align-items: center; font-weight: bold; border-bottom: 1px solid #ddd;
    }
    header .title { color: #007bff; font-size: 18px; }
    header .balance-display { font-size: 14px; color: green; }
    .profile { text-align: center; padding: 20px; }
    .profile img { width: 80px; height: 80px; border-radius: 50%; }
    .name { font-size: 18px; margin: 5px 0; color: #007bff; }
    .balance { color: gray; }
    .usd { font-size: 20px; margin: 10px 0; }
    .card { background: white; margin: 15px; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .progress { height: 10px; background: #eee; border-radius: 5px; margin-top: 10px; }
    .bar { height: 10px; background: #007bff; width: 0%; border-radius: 5px; transition: 0.3s; }
    .nav { position: fixed; bottom: 0; width: 100%; display: flex; justify-content: space-around; background: white; border-top: 1px solid #ccc; padding: 10px 0; }
    .nav div { text-align: center; font-size: 14px; cursor: pointer; color: gray; }
    .nav img { width: 24px; height: 24px; display: block; margin: 0 auto 5px; filter: grayscale(1); }
    .nav .active { color: #007bff; font-weight: bold; }
    .nav .active img { filter: none; }
    .button { background: #007bff; color: white; padding: 10px; text-align: center; border-radius: 5px; margin-top: 10px; cursor: pointer; }
    input, select { width: 100%; padding: 8px; margin-top: 8px; border: 1px solid #ccc; border-radius: 5px; }
  </style>
  <script>
    const monetagZoneId = 9526255;
    const monetagUrl = `https://www.monetag.com/engine/?zone=${monetagZoneId}`;
  </script>
</head>
<body>
<!-- ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡¶¨ HTML ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá --><script src="https://telegram.org/js/telegram-web-app.js"></script><script>
  const tg = window.Telegram.WebApp;
  const userId = tg.initDataUnsafe?.user?.id || Math.floor(Math.random() * 1000000);
  const username = tg.initDataUnsafe?.user?.username || "Guest";
  const ref = new URLSearchParams(window.location.search).get("start");

  const today = new Date().toLocaleDateString();

  let userData = JSON.parse(localStorage.getItem("MTEarningData")) || {
    userId, username, referrals: 0, lifetimeEarning: 0
  };

  let data = JSON.parse(localStorage.getItem("dailyEarningData")) || {
    date: today, completed: 0, remaining: 100, todaysEarning: 0
  };

  if (data.date !== today) {
    data = { date: today, completed: 0, remaining: 100, todaysEarning: 0 };
  }

  if (ref && ref.startsWith("ref_")) {
    const refId = ref.split("ref_")[1];
    const referredUsers = JSON.parse(localStorage.getItem(`referrals_${refId}`)) || [];
    if (!referredUsers.includes(userId)) {
      referredUsers.push(userId);
      localStorage.setItem(`referrals_${refId}`, JSON.stringify(referredUsers));
      if (userId !== refId) {
        const refCount = parseInt(localStorage.getItem(`ref_count_${refId}`) || "0");
        localStorage.setItem(`ref_count_${refId}`, refCount + 1);
      }
    }
  }

  const refCount = parseInt(localStorage.getItem(`ref_count_${userId}`) || "0");
  userData.referrals = refCount;

  function updateStorage() {
    localStorage.setItem("MTEarningData", JSON.stringify(userData));
    localStorage.setItem("dailyEarningData", JSON.stringify(data));
  }

  function updateDisplay() {
    document.getElementById("username").innerText = username;
    document.getElementById("completed").innerText = data.completed;
    document.getElementById("remaining").innerText = data.remaining;
    document.getElementById("ecompleted").innerText = data.completed;
    document.getElementById("eremaining").innerText = data.remaining;
    document.getElementById("todays-earning").innerText = data.todaysEarning.toFixed(2);
    document.getElementById("lifetime-earning").innerText = userData.lifetimeEarning.toFixed(2);
    document.getElementById("usd-balance").innerText = "USD $" + userData.lifetimeEarning.toFixed(2);
    document.getElementById("available").innerText = userData.lifetimeEarning.toFixed(2);
    document.getElementById("header-balance").innerText = "$" + userData.lifetimeEarning.toFixed(2);
    document.getElementById("progress-bar").style.width = (data.completed / 50 * 100) + "%";
    document.getElementById("ref-count").innerText = userData.referrals;
  }

  function startTask() {
    if (data.completed >= 100) return alert("You have completed all tasks for today!");

    const start = Date.now();
    const ad = window.open(monetagUrl, "_blank");

    const check = setInterval(() => {
      if (ad.closed) {
        clearInterval(check);
        const duration = (Date.now() - start) / 1000;
        if (duration >= 30) {
          data.completed++;
          data.remaining--;
          data.todaysEarning += 0.05;
          userData.lifetimeEarning += 0.05;
          updateStorage();
          updateDisplay();
          alert("‚úÖ Task completed! $0.05 added.");
        } else {
          alert("‚è±Ô∏è You must view the ad for at least 30 seconds.");
        }
      }
    }, 500);
  }

  function submitWithdrawal() {
    const amount = parseFloat(document.getElementById("withdraw-amount").value);
    if (isNaN(amount) || amount < 50) return alert("You need at least $50 to withdraw.");
    if (amount > userData.lifetimeEarning) return alert("Insufficient balance.");
    if (userData.referrals < 10) return alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ñ‡¶®‡ßã ‡ßß‡ß¶‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶π‡ßü‡¶®‡¶ø! ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶¨‡¶æ‡¶∞ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶§‡ßá ‡¶π‡¶≤‡ßá ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß‡ß¶‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§");
    alert("Withdrawal submitted!");
  }

  function show(section) {
    document.querySelector('.profile').style.display = section === 'home' ? 'block' : 'none';
    document.querySelectorAll('.card').forEach(c => c.style.display = 'none');
    if (section === 'home') document.querySelectorAll('.card').forEach((c, i) => i < 2 && (c.style.display = 'block'));
    else document.getElementById(section).style.display = 'block';
    document.querySelectorAll('.nav div').forEach(div => div.classList.remove('active'));
    document.getElementById("nav-" + section).classList.add('active');
  }

  function copyReferralLink() {
    const refLink = `https://t.me/TaskTycoon_bot?start=ref_${userId}`;
    navigator.clipboard.writeText(refLink)
      .then(() => alert("‚úÖ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! üë´ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶≤‡ßç‡¶™ ‡¶∏‡¶Æ‡ßü‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá Facebook Video ‡¶ï‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® !"))
      .catch(() => alert("Failed to copy link."));
  }

  updateDisplay();
  updateStorage();
</script></body>
</html>
